# rc_perception/config/perception.yaml

lane_node:
  ros__parameters:
    image_topic: /cam_bottom/image_raw
    show_debug: false
    crop_h_start_ratio: 0.5
    black_v_max: 60
    min_contour_area: 300
    angle_max_deg: 30.0
    frame_id: camera_bottom

marker_pose_node:
  ros__parameters:
    # 입력
    image_topic: /cam_front/image_raw
    camera_info_topic: /cam_front/camera_info
    
    # 출력
    pose_topic: /perception/marker_pose
    status_topic: /perception/marker_status
    
    # 디버그
    show_debug: true
    log_throttle_sec: 1.0
    
    # ArUco 설정
    aruco_dict: DICT_4X4_50
    marker_length_m: 0.04     # 4cm 마커
    id_offset: 0
    
    # 검출 필터링
    min_marker_area_px: 100
    quality_area_ref_px: 2500.0
    target_id: -1             # -1 = 가장 큰 마커 선택
    
    # ID 유지 (hysteresis)
    prefer_last_id: true
    prefer_last_id_sec: 0.35
    
    # pose 검증
    min_z_m: 0.02
    max_z_m: 2.0
    max_xy_m: 2.0
    max_step_m: 0.3
    
    # 스무딩
    enable_smoothing: true
    ema_alpha: 0.4
    
    # 타이밍
    timer_period_sec: 0.05    # 20Hz
    
    # TF 발행
    publish_tf: true
    tf_child_prefix: marker_

parking_line_node:
  ros__parameters:
    image_topic: /cam_side/image_raw
    output_topic: /perception/parking_line
    show_debug: false
    roi_y_min_ratio: 0.45
    roi_y_max_ratio: 1.0
    canny1: 50
    canny2: 150
    hough_threshold: 40
    min_line_length: 40
    max_line_gap: 20
    min_quality: 0.15
    prefer_vertical: true

slot_marker_node:
  ros__parameters:
    image_topic: /cam_side/image_raw
    camera_info_topic: /cam_side/camera_info
    pose_topic: /perception/slot_marker_pose
    camera_frame: camera_side
    marker_size_m: 0.02
    slot_id_min: 16
    slot_id_max: 99
    min_marker_area_px: 200
    publish_best_only: true
    publish_tf: false